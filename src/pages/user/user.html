<ion-header>
    <ion-navbar color="dado">
        <h3 class="nameTop light">{{user.name}}</h3>
        <ion-buttons end>
            <button ion-button (click)="logout()">
                <ion-icon name="log-out"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar> 
</ion-header>

<ion-content>
    <div class="profileBack">
        <div style="text-align:center;">
            <img src="{{ user.photoUrl }}" class="profileImage" (click)="takePicture('SELF')">
        </div>
    </div>

    <ion-segment class="profileButtons" [(ngModel)]="tabs">
        <ion-segment-button value="profile">
            {{'Perfil' | translate}}
        </ion-segment-button>
        <ion-segment-button value="docs">
            {{'Documentos' | translate}}
        </ion-segment-button>
        <ion-segment-button value="residence">
            {{'Residência' | translate}}
        </ion-segment-button>
        <ion-segment-button value="cardsetting" (click)="getTrips()">
            Meio de Pagamento
        </ion-segment-button>
        <ion-segment-button value="ridehistroy" (click)="getTrips()">
            Corridas
        </ion-segment-button>
    </ion-segment>
    <div [ngSwitch]="tabs">
        <div *ngSwitchCase="'profile'">
            <ion-list>
                <ion-item>
                    <ion-label stacked>{{'FULLNAME' | translate}}</ion-label>
                    <ion-input type="text" [(ngModel)]="user.name" disabled></ion-input>
                </ion-item>
                <ion-item>
                    <ion-label stacked>{{'EMAIL_ADDRESS' | translate}}</ion-label>
                    <ion-input type="email" [(ngModel)]="user.email" [disabled]="tem_email"></ion-input>
                    <button ion-button item-right clear *ngIf="!user.isEmailVerified"
                            (click)="verifyEmail()">{{'VERIFY' | translate}}</button>
                </ion-item>
                <ion-item>
                    <ion-label stacked>{{'Celular' | translate}}</ion-label>
                    <ion-input type="tel" [(ngModel)]="user.phoneNumber" [disabled]="user.isPhoneVerified"
                               [brmasker]="{phone: true}"></ion-input>
                    <button ion-button item-right clear *ngIf="!user.isPhoneVerified"
                            (click)="verifyPhone()">{{'VERIFY' | translate}}</button>
                </ion-item>
                <ion-item>
                    <ion-label stacked>CPF</ion-label>
                    <ion-input [(ngModel)]="user.itin" [brmasker]="{mask:'000.000.000-00', len:14}" maxlength="14" disabled></ion-input>
                </ion-item>
                <ion-item>
                    <ion-label stacked>RG</ion-label>
                    <ion-input [(ngModel)]="user.id_card" [brmasker]="{mask:'00.000.000-00', len:13}"  maxlength="13"></ion-input>
                </ion-item>
                <ion-item>
                    <ion-label stacked>Nascimento</ion-label>
                    <ion-datetime [(ngModel)]="user.birthdate" displayFormat="DD/MM/YYYY" [max]="year" disabled></ion-datetime>
                </ion-item>
                <ion-item>
                    <ion-label stacked>Banco</ion-label>
                    <ion-select type="text" [(ngModel)]="user.bank">
                        <ion-option value="{{bank.Code}}" *ngFor="let bank of banks">
                            {{ bank.Name}}
                        </ion-option>
                    </ion-select>
                </ion-item>
                <ion-item>
                    <ion-label stacked>Agência</ion-label>
                    <ion-input maxlength="10" type="text" [(ngModel)]="user.agency"></ion-input>
                </ion-item>
                <ion-item>
                    <ion-label stacked>Conta</ion-label>
                    <ion-input maxlength="20" type="text" [(ngModel)]="user.account"></ion-input>
                </ion-item>
            </ion-list>
        </div>

        <!-- Inicio Aba Docs -->
        <div *ngSwitchCase="'docs'">
            <div style="text-align:center;">
                <ion-label stacked>RG/CNH</ion-label>
                <img src="{{ user.photoCNH }}" class="profileImage" (click)="takePicture('CNH')">
                <ion-label stacked>Comprovante Residência</ion-label>
                <img src="{{ user.photoComprovante }}" class="profileImage" (click)="takePicture('COMPROVANTE')">
            </div>
        </div>
        <!-- docs até aqui... -->

        <div *ngSwitchCase="'residence'">
            <ion-item>
                <ion-label stacked>CEP</ion-label>
                <ion-input [(ngModel)]="user.zipcode" (ionBlur)="getCep()" type="text" maxlength="9" [brmasker]="{mask:'00000-000', type:'num'}"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Endereço</ion-label>
                <ion-input [(ngModel)]="user.address" type="text"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Número</ion-label>
                <ion-input [(ngModel)]="user.number" type="text"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Complemento</ion-label>
                <ion-input [(ngModel)]="user.complement" type="text" required="true"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Bairro</ion-label>
                <ion-input [(ngModel)]="user.neighborhood" type="text"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Cidade</ion-label>
                <ion-input [(ngModel)]="user.city" type="text"></ion-input>
            </ion-item>

            <ion-item>
                <ion-label stacked>Estado</ion-label>
                <ion-input [(ngModel)]="user.state" type="text"></ion-input>
            </ion-item>
        </div>
        <div *ngSwitchCase="'cardsetting'" padding>
            <ion-grid>
                <ion-row>
                    <ion-item>
                        <ion-label stacked>{{'CARD_NUMBER' | translate}}</ion-label>
                        <ion-input type="text" [(ngModel)]="number" size="20"></ion-input>
                    </ion-item>
                </ion-row>
                <ion-row class="split-row">
                    <ion-col col-6>
                        <ion-item>
                            <ion-label stacked>{{'EXPIRE_DATE' | translate}} (MM/YY)</ion-label>
                            <ion-input type="text" [(ngModel)]="exp" size="5"></ion-input>
                        </ion-item>
                    </ion-col>
                    <ion-col col-6>
                        <ion-item>
                            <ion-label stacked>{{'CVV' | translate}}</ion-label>
                            <ion-input type="text" [(ngModel)]="cvv" size="4"></ion-input>
                        </ion-item>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <button ion-button block (click)="saveCard()">Salvar Cartão</button>
        </div>
        <div *ngSwitchCase="'ridehistroy'">
            <ion-card *ngFor="let trip of trips">
                <ion-card-content>
                    <ion-row>
                        <ion-col>
                            <h1 style="color: #8BC34A; font-weight: 600;">{{trip.currency}} {{ trip.fee - (trip.fee * trip.discount / 100) }}</h1>
                            <p>Pagamento: {{ trip.paymentMethod }}</p>
                            <p>ID: {{ trip.createdAt }}</p>
                        </ion-col>
                        <ion-col>
                            <p>{{'FEE' | translate}}: {{trip.currency}} {{trip.fee}}</p>
                            <p>Promo: {{ trip.promo}}</p>
                            <p>Desconto: {{trip.discount}}</p>
                        </ion-col>
                    </ion-row>
                    <ion-item>
                        <h2>De ({{ trip.pickedUpAt | date: 'medium'}})</h2>
                        <p>{{ trip.origin.vicinity }}</p>
                    </ion-item>
                    <ion-item>
                        <h2>Até ({{ trip.droppedOffAt | date: 'medium'}})</h2>
                        <p>{{ trip.destination.vicinity }}</p>
                    </ion-item>
                </ion-card-content>
            </ion-card>
        </div>
    </div>
    <div style="padding: 5px;">
        <button ion-button block (click)="save()">{{'SAVE' | translate}}</button>
    </div>
</ion-content>
